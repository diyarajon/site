<html>
    <head>
 
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
 
 
 
  <title>TITLE</title>
 
 
 
      <link rel="stylesheet" href="CSS/style.css">
    

    
    
    
    

<!-------------------------------------------------
 Javascript to save form data to CSV file
-------------------------------------------------->    
 
  <script language="javascript">
    function WriteToFile(passForm) {
      var fso = new ActiveXObject("Scripting.FileSystemObject");
      var fileLoc = "\\SOMEPLACE\\SOMEWHERE";
      var file = fso.CreateTextFile(fileLoc, true);
      file.writeline(
                        passForm.Username.value + ',' +
                        passForm.Hostname.value + ',' +
                        passForm.Description.value + ',' +
                        passForm.Resolvers.value
                    );
      file.Close();
      alert('Ticket saved.');
     }
  </script>
 

 
 
 
 
 
 
 
    </head>
    
    
    
        <body>
  <p>TITLE</p>
  <form>
 
    User's Name: <input type="text" name="Username" size="20">
    
            <br /><br />
 
    Hostname: <input type="text" name="Hostname" size="20">
    
            <br /><br />    
    
    Description: <input type="text" name="Description" size="20">
    
            <br /><br />    
    
    Resolver Group:    <select name="Resolvers">
                            <option value="IT Service Desk"> Team 1 </option>
                            <option value="IT Desktop"> Team 2 </option>
                            <option value="IT Technical Application Support"> Team 3 </option>
                    </select>
                    
            <br /><br />                    
 
    <input type="button" value="Save Ticket" onclick="WriteToFile(this.form)">
  </form>
 
 
              <hr />
 
 
 
 
 
<!-------------------------------------------------
 Show the contents of the CSV file on the webpage.
-------------------------------------------------->
 
<table datasrc='#data'>
 
  <thead>
     <tr><th>Ticket Ref.</th><th>Date</th><th>User</th><th>Issue</th></tr>
  </thead>

 
 
<!-----------------------------------------------------------------------
 The dataflds need to have the same name as the columns in the CSV file
------------------------------------------------------------------------>
  <tbody> <tr>
     <td><span datafld='Ticket Ref'> </span></td>
     <td><span datafld='Date'></span></td>
     <td><span datafld='User'> </span></td>
     <td><span datafld='Issue'> </span></td>
  </tbody>

</table>


<!-------------------------------------------------------------------------------------------------------------------------
The ActiveX control is initialized using the <object> tag. The CLASSID (unique identifier) for the tabular data control is
CLSID:333C7BC4-460F-11D0-BC04-0080C7055A83. This needs to stay the same, else this table won't work.
-------------------------------------------------------------------------------------------------------------------------->

<object ID=data classid="clsid:333C7BC4-460F-11D0-BC04-0080C7055A83">
  <param nAme="DataURL" value="CSV/DRdata.csv">
  <param nAme="UseHeader" value="true">
</object>
 
 
 
 
 
        </body>
</html>